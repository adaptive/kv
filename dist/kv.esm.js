import{AwsClient as t}from"aws4fetch";export default class{constructor(e="main"){this.namespace=e,this.prefix=`https://${KV_S3_BUCKET}/${e}`,this.aws=new t({accessKeyId:KV_ACCESS_KEY_ID,secretAccessKey:KV_SECRET_ACCESS_KEY,region:KV_DEFAULT_REGION,service:"s3"})}async put(t,e="",s=!1){if(!t)throw"missing key on .put()";return await this.aws.fetch(`${this.prefix}/${t}`,{body:e,method:"PUT"}),!0}async get(t,e="text"){if(!t)throw"missing key on .get()";if(!["text","json"].includes(e))throw"invalid type on .get()";const s=await this.aws.fetch(`${this.prefix}/${t}`);return"text"===e?s.text():"json"===e?s.json():void 0}async delete(t){if(!t)throw"missing key on .delete()";return await this.aws.fetch(`${this.prefix}/${t}`,{method:"DELETE"}),!0}}
